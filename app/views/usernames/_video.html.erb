<div id="player">
    <script type="text/javascript">
     $(document).ready(function() {
      function loadPlayer(id, user_id, song) { 
               
    UserId = user_id

    if (typeof(YT) == 'undefined' || typeof(YT.Player) == 'undefined') {

      var tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
  
     
      window.onYouTubePlayerAPIReady = function(id) {
        onYouTubePlayer(id)
      };

    } else {
      
     onYouTubePlayer(id)
      PageTitle(song);
    }
  }

function PageTitle(song) {

  document.title = song
};

      // 3. This function creates an <iframe> (and YouTube player)
      //    after the API code downloads.
      var player;
      function onYouTubePlayer(id) {
        player = new YT.Player('player', {
          height: '300',
          width: '400',
          videoId: '<%= video_id(@song)%>',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange,
            'onError': onError

          }
        });
      }
  loadPlayer('<%= video_id(@song)%>', '<%= @user.id %>' , '<%= @song %>' );
});
     </script>
</div> 	
    <%= link_to "Shuffle", shuttle_path(:username => @user, :current_song => @song) , remote:true , :class => "btn btn-default shuffle" %> 

	 <%= social_share_button_tag(@song,  :url => "http://www.youtube.com/embed/" + video_id(@song) , desc:  @song) %>
  </div>
</div>


